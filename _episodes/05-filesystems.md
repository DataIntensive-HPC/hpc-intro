---
layout: episode
title: "File systems and file transfer"
teaching: 10
exercises: 0
questions:
  - "What is the difference between the AFS and Lustre file systems?"
  - "How can I transfer large amount of data to/from PDC?"
objectives:
  - "Learn to navigate the file systems at PDC"
  - "Learn to transfer files to/from PDC"
keypoints:
  - "K1"
  - "K2"
---

# File systems at PDC

When working on a PDC cluster, you will be interacting with two different file systems. 
The differing properties of the two systems are important to understand in order make the most out 
of PDC's resources.

## Andrew File System - AFS

- AFS is a (globally) distributed file system accessible to any running AFS client.
- Your main home directory is on AFS: `/afs/pdc.kth.se/home/[initial]/[username]`
- Access to your AFS home directory is enabled by your Kerberos ticket, and the *AFS token* generated by it.

## Lustre file system (klemming)

- Nicknamed *klemming* at PDC.
- Lustre is an open-source massively parallel distributed file system.
- Very high performance (5PB storage - 130GB/s bandwidth).
- PDC users have two klemming directories:
  - `/cfs/klemming/nobackup/[initial]/[username]`: used for running jobs, input, output...
  - `/cfs/klemming/scratch/[initial]/[username]`: used for temporary files (old files get deleted).
- High file access speed, but performance deteriorates for many (~10<sup>5</sup>) small files.

## Differences between AFS and Lustre

- AFS home directories are backed up every day (lost files can be retrieved!) - Lustre is not backed up.
- AFS is *not accessible* to compute nodes on Beskow. All jobs must run on Lustre.
- AFS has limited usage quota, typically 5 GB per user - no quota is enforced on Lustre.
- Lustre is a high-performance file system - AFS is slow.
- Lustre supports standard (POSIX) Access Control Lists (ACLs) - AFS has own implementation of ACLs.

> ## Exploring your AFS directory
>
> If you haven't already done so, log in to Tegner:
> ```
> $ ssh <username>@tegner.pdc.kth.se
> ```
> {: .bash}
> After logging in, check your current location:
> ```
> $ pwd
> ```
> {: .bash}
> This is your AFS home directory, which is also stored in the `HOME` 
> environment variable:
> ```
> $ echo $HOME
> /afs/pdc.kth.se/home/<initial>/<username>
> ```
> {: .bash}
> You can check your disk quota using the following command:
> ```
> $ fs listquota
> # or the shortcut: 
> $ fs lq
> ```
> {: .bash}
> This is an example of a `fs` subcommand. To see all 
> available subcommands, type
> ```
> $ fs help
> ```
> {: .bash}
> **Which command can you use to list the access control lists (ACLs)?**
> 
> You also have two "special" directories already set up in your AFS 
> home directory: `Public` is a publicly readable directory and is useful 
> for sharing files with collaborators, and `Private` is a non-readable, 
> non-listable directory for your secrets.   
> **Use the command you found for listing access control lists to compare
> the ACLs in `$HOME`, `$HOME/Public` and `$HOME/Private`.**
{: .challenge}


> ## Creating and managing AFS groups
>
> Sometimes
> ```
> $ 
> ```
> {: .bash}
> ```
> $ ssh <username>@tegner.pdc.kth.se
> ```
> {: .bash}
> 
>
>
{: .challenge}


> ## Exploring your Lustre directories
>
> If you haven't already done so, log in to Tegner:
> ```
> $ ssh <username>@tegner.pdc.kth.se
> ```
> {: .bash}
> After logging in, check your current location:
> ```
> $ pwd
> ```
> {: .bash}
> This is your AFS home directory.  
> 
> ```
> $ ssh <username>@tegner.pdc.kth.se
> ```
> {: .bash}
> ```
> $ ssh <username>@tegner.pdc.kth.se
> ```
> {: .bash}
> ```
> $ ssh <username>@tegner.pdc.kth.se
> ```
> {: .bash}
> ```
> $ ssh <username>@tegner.pdc.kth.se
> ```
> {: .bash}
> 
>
>
{: .challenge}
